# +
# -*- coding: utf-8 -*-
# Copyright (c) Meta Platforms, Inc. and affiliates.
#
# pytx documentation build configuration file, created by
# Author:MengXuan Chen
# date:2024.3.28
# Institute:JSPI

import os
import numpy as np
import matplotlib.pyplot as plt
import scipy as sp
import pandas as pd


# -

#给定一个目录，遍历得到该目录下全部文件
def GetAllFile(dirpath):
    file_list=[] 
    if not os.path.isdir(dirpath):
        return
    list_dirs=os.walk(dirpath)
    for root,dirs,files in list_dirs:
        for f in files:
            file_list.append(os.path.join(root,f)) #保存路径名为f的文件路径
    return file_list

#各种类型可能的文件后缀名
Filetype=["Code File","Image File","Text File","Video","Certificate File","System File","Archieve File","Other"]
CodeExtension=[".so",".cpp",".java",".py",".smali",".h",".js",".dex",".php",".bas",".pas",".for",".css"]
BinaryExtension=[".dll",".exe",".sh",".com",".reg",".bat",".sys",".dat",".ini",".log",".tmp",".bmp",".bak"]
ImageExtension=[".jpg",".jpeg",".png",".gif"]
TextExtension=[".htm",".html",".txt",".doc",".docx",".xls",".xlsx",".csv"\
               ,".ppt",".pptx",".pdf",".xml",".wps"]
CertificateExtension=[".RSA",".SF",".MF"]
ArchieveExtension=[".zip",".rar",".lzh",".jar",".cab",".7z"]
VideoExtension=[".avi",".mp4",".mov",".flv",".mkv",".psd",".mpeg",".wma",".wav"]

#各种类型文件数量的统计
def FileNum(filelist):
    TypePercentage=[0,0,0,0,0,0,0,0]
    for file in filelist:
        extension=os.path.splitext(file)[1]
        if extension in CodeExtension:
            TypePercentage[0]+=1
        elif extension in ImageExtension:
            TypePercentage[1]+=1
        elif extension in TextExtension:
            TypePercentage[2]+=1
        elif extension in VideoExtension:
            TypePercentage[3]+=1
        elif extension in CertificateExtension:
            TypePercentage[4]+=1
        elif extension in ArchieveExtension:
            TypePercentage[5]+=1
        elif extension in BinaryExtension:
            TypePercentage[6]+=1
        else:
            TypePercentage[-1]+=1
            #print(file)
    return TypePercentage


FileS=GetAllFile(r"D:\Downloads\APK分析工具\7.案例\cmx")
FileNum(FileS)


#各种类型文件占安卓压缩包的百分比
def FileSize(filelist):
    SizePercentage=[0]*8
    for file in filelist:
        extension=os.path.splitext(file)[1]
        if extension in CodeExtension:
            SizePercentage[0]+=os.path.getsize(file)
        elif extension in ImageExtension:
            SizePercentage[1]+=os.path.getsize(file)
        elif extension in TextExtension:
            SizePercentage[2]+=os.path.getsize(file)
        elif extension in VideoExtension:
            SizePercentage[3]+=os.path.getsize(file)
        elif extension in CertificateExtension:
            SizePercentage[4]+=os.path.getsize(file)
        elif extension in ArchieveExtension:
            SizePercentage[5]+=os.path.getsize(file)
        elif extension in BinaryExtension:
            SizePercentage[6]+=os.path.getsize(file)
        else:
            SizePercentage[-1]+=os.path.getsize(file)
            #print(file)
    return SizePercentage


FileSize(FileS)


